[
  {
    "path": "posts/2021-02-04-curso-r-regresso-linear-br-exerccios-rlsm/",
    "title": "Curso-R: Regressão Linear <br> Exercícios RLSM",
    "description": "A short description of the post.",
    "author": [
      {
        "name": "Elizabeth Mie Hashimoto",
        "url": {}
      }
    ],
    "date": "2021-01-25",
    "categories": [],
    "contents": "\nPacotes\n\n\nlibrary(tidyverse) # manipulacao de data.frame\nlibrary(MASS) # dados Boston\nlibrary(broom)\n\n\n\nDados\nO banco de dados Boston apresenta registros de valores medianos das casas (medv) de 506 bairros de Boston. O objetivo é identificar quais das 13 variáveis explicativas estão associadas com esses valores e usá-las para fazer predições de preços das casas.\n\n\nglimpse(Boston)\n\n\nRows: 506\nColumns: 14\n$ crim    <dbl> 0.00632, 0.02731, 0.02729, 0.03237, 0.06905, 0.0298…\n$ zn      <dbl> 18.0, 0.0, 0.0, 0.0, 0.0, 0.0, 12.5, 12.5, 12.5, 12…\n$ indus   <dbl> 2.31, 7.07, 7.07, 2.18, 2.18, 2.18, 7.87, 7.87, 7.8…\n$ chas    <int> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …\n$ nox     <dbl> 0.538, 0.469, 0.469, 0.458, 0.458, 0.458, 0.524, 0.…\n$ rm      <dbl> 6.575, 6.421, 7.185, 6.998, 7.147, 6.430, 6.012, 6.…\n$ age     <dbl> 65.2, 78.9, 61.1, 45.8, 54.2, 58.7, 66.6, 96.1, 100…\n$ dis     <dbl> 4.0900, 4.9671, 4.9671, 6.0622, 6.0622, 6.0622, 5.5…\n$ rad     <int> 1, 2, 2, 3, 3, 3, 5, 5, 5, 5, 5, 5, 5, 4, 4, 4, 4, …\n$ tax     <dbl> 296, 242, 242, 222, 222, 222, 311, 311, 311, 311, 3…\n$ ptratio <dbl> 15.3, 17.8, 17.8, 18.7, 18.7, 18.7, 15.2, 15.2, 15.…\n$ black   <dbl> 396.90, 396.90, 392.83, 394.63, 396.90, 394.12, 395…\n$ lstat   <dbl> 4.98, 9.14, 4.03, 2.94, 5.33, 5.21, 12.43, 19.15, 2…\n$ medv    <dbl> 24.0, 21.6, 34.7, 33.4, 36.2, 28.7, 22.9, 27.1, 16.…\n\n\n\n# Descrição das variáveis\nhelp(Boston)\n\n\n\nExercício 1\nFaça um gráfico de dispersão entre medv e rm.\n\n\nBoston %>% \n  ggplot() +\n  geom_point(aes(x = rm, y = medv)) +\n  labs(x = 'Número médio de quartos por habitação', y = 'Preço mediano das habitações do bairro (em 1000 dólares)')\n\n\n\n\nExercício 2\nAjuste um modelo de regressão linear simples utilizando medv como resposta e rm como explicativa e guarde em objeto chamado mod_simples. Consulte o summary(mod_simples) em seguida.\n\n\nmod_simples <- lm(medv ~ rm, data=Boston)\nsummary(mod_simples)\n\n\n\nCall:\nlm(formula = medv ~ rm, data = Boston)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-23.346  -2.547   0.090   2.986  39.433 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  -34.671      2.650  -13.08   <2e-16 ***\nrm             9.102      0.419   21.72   <2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 6.616 on 504 degrees of freedom\nMultiple R-squared:  0.4835,    Adjusted R-squared:  0.4825 \nF-statistic: 471.8 on 1 and 504 DF,  p-value: < 2.2e-16\n\nExercício 3\nSabendo que medv é o preço mediano das habitações do bairro e o rm é o número médio de quartos por habitação,\ninterprete o parâmetro (Intercept).\n\\(\\blacktriangleright\\) Resposta: Nesse caso, -34.671 \\(\\times\\) 1000 dólares é a média do preço mediano das habitações quando temos zero quartos por habitação.\ninterprete o parâmetro rm.\n\\(\\blacktriangleright\\) Resposta: A cada um quarto por habitação que aumentamos por habitação, temos um acréscimo de 9.102 \\(\\times\\) 1000 dólares na média do preço mediano das habitações.\no número de quartos está associado com o valor da habitação? Por quê?\n\\(\\blacktriangleright\\) Resposta: Sim, pois ao nível de significância de 5%, rejeitamos a hipótese nula (\\(H_0: \\beta_1=0\\)), uma vez que o \\(p\\)-valor é menor do que 0,001. Dessa forma, temos evidências de que o preço mediano das habitações tem alguma relação com o número médio de quartos por habitação.\nExercício 4\nConsulte as saídas das funções\ncoef(mod_simples): mostra apenas as estimativas dos coeficientes de regressão.\nconfint(mod_simples): mostra o intervalo de 95% de confiança das estimativas dos coeficientes de regressão.\npredict(mod_simples): calcula os valores preditos do preço mediano das habitações, isto é, \\(\\hat{\\mbox{medv}}=-34,671+9,102 rm\\).\npredict(mod_simples, interval = \"confidence\"): calcula os valores preditos do preço mediano das habitações e o intervalo de 95% de confiança de cada valor predito.\naugment(mod_simples): cria um data frame com valores de medv, rm, valores preditos, resíduo e distância de Cook.\n\n\ncoef(mod_simples)\n\n\n(Intercept)          rm \n -34.670621    9.102109 \n\nconfint(mod_simples)\n\n\n                 2.5 %     97.5 %\n(Intercept) -39.876641 -29.464601\nrm            8.278855   9.925363\n\npredict(mod_simples) %>% head(n=10L)\n\n\n       1        2        3        4        5        6        7 \n25.17575 23.77402 30.72803 29.02594 30.38215 23.85594 20.05126 \n       8        9       10 \n21.50760 16.58335 19.97844 \n\npredict(mod_simples, interval = \"confidence\") %>% head(n=10L)\n\n\n        fit      lwr      upr\n1  25.17575 24.55039 25.80110\n2  23.77402 23.18536 24.36269\n3  30.72803 29.78817 31.66790\n4  29.02594 28.20203 29.84984\n5  30.38215 29.46676 31.29755\n6  23.85594 23.26582 24.44606\n7  20.05126 19.43134 20.67118\n8  21.50760 20.92234 22.09285\n9  16.58335 15.79375 17.37296\n10 19.97844 19.35611 20.60078\n\naugment(mod_simples)\n\n\n# A tibble: 506 x 8\n    medv    rm .fitted  .resid .std.resid    .hat .sigma     .cooksd\n   <dbl> <dbl>   <dbl>   <dbl>      <dbl>   <dbl>  <dbl>       <dbl>\n 1  24    6.58    25.2 -1.18      -0.178  0.00231   6.62 0.0000367  \n 2  21.6  6.42    23.8 -2.17      -0.329  0.00205   6.62 0.000111   \n 3  34.7  7.18    30.7  3.97       0.602  0.00523   6.62 0.000952   \n 4  33.4  7.00    29.0  4.37       0.662  0.00402   6.62 0.000885   \n 5  36.2  7.15    30.4  5.82       0.882  0.00496   6.62 0.00194    \n 6  28.7  6.43    23.9  4.84       0.733  0.00206   6.62 0.000555   \n 7  22.9  6.01    20.1  2.85       0.431  0.00227   6.62 0.000212   \n 8  27.1  6.17    21.5  5.59       0.846  0.00203   6.62 0.000727   \n 9  16.5  5.63    16.6 -0.0834    -0.0126 0.00369   6.62 0.000000295\n10  18.9  6.00    20.0 -1.08      -0.163  0.00229   6.62 0.0000306  \n# … with 496 more rows\n\nExercício 5\nUsando o data.frame gerado por augment(mod_simples) faça um gráfico de medv versus rm e em seguida desenhe a reta ajustada do mod_simples.\n\n\nboston_pred <- augment(mod_simples)\n\nboston_pred %>% \n  ggplot() +\n  geom_point(aes(x = rm, y = medv)) +\n  geom_line(aes(x = rm, y = .fitted), color=\"red\") +\n  labs(x = 'Número médio de quartos por habitação', y = 'Preço mediano das habitações do bairro (em 1000 dólares)')\n\n\n\n\nExercício 6\nFaça um gráfico de resíduos. Coloque os resíduos no eixo Y e os valores ajustados no eixo X.\n\n\nboston_pred %>% \n  ggplot() +\n  geom_point(aes(x = .fitted, y = .std.resid)) +\n  geom_hline(yintercept=0, linetype=\"dashed\") +\n  labs(x = 'Valores ajustados', y = 'Resíduos')\n\n\n\n\nExercício 7\nObserve os gráficos de plot(mod_simples).\n\n\nplot(mod_simples)\n\n\n\n\nApenas pela inspeção visual, responda: existem outliers? Eles são pontos de alavanca?\n\\(\\blacktriangleright\\) Resposta: Por meio das figuras, observamos que os pontos \\(\\sharp366\\), \\(\\sharp369\\) e \\(\\sharp373\\) são possíveis outliers. O gráfico de Residuals vs Leverage indica que não são pontos de alavanca.\nExercício 8\nAjuste um modelo mod_multiplo para medv explicado por rm e crim. Consulte o summary(mod_multiplo) em seguida.\n\n\nmod_multiplo <- lm(medv ~ rm + crim, data=Boston)\nsummary(mod_multiplo)\n\n\n\nCall:\nlm(formula = medv ~ rm + crim, data = Boston)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-21.608  -2.835  -0.380   2.592  38.839 \n\nCoefficients:\n             Estimate Std. Error t value Pr(>|t|)    \n(Intercept) -29.24472    2.58809 -11.300   <2e-16 ***\nrm            8.39107    0.40485  20.726   <2e-16 ***\ncrim         -0.26491    0.03307  -8.011    8e-15 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 6.237 on 503 degrees of freedom\nMultiple R-squared:  0.542, Adjusted R-squared:  0.5401 \nF-statistic: 297.6 on 2 and 503 DF,  p-value: < 2.2e-16\n\nExercício 9\nQual modelo ficou melhor: mod_simples ou mod_multiplo? Qual critério você utilizou para decidir o melhor?\n\\(\\blacktriangleright\\) Resposta: O mod_multiplo parece ser melhor do que o mod_simples, porque, considerando o R2 ajustado, o R2 ajustado do mod_multiplo (0,5401) é maior do que o R2 ajustado do mod_simples (0,4825). Além disso, a variável crim é significativa (\\(p\\)-valor < 0,001) para explicar a variablidade presente na média do preço mediano das habitações, considerando um nível de significância de 5%.\nPor outro lado, pelos resíduos, ambos os modelos tem problemas com em relação a normalidade dos resíduos e com uma possível relação não linear entre a variável resposta e as variáveis explicativas. O que indica que o modelo mod_multiplo pode ser melhorado.\n\n\n# Resíduo modelo múltiplo\nplot(mod_multiplo)\n\n\n\n\n\n\n\nExercício 10\nAjuste um modelo mod_completo para medv explicado por todas as demais colunas. DICA: na fórmula medv ~ ., o ponto significa “todas as variáveis, tirando medv”.\nConsulte o summary(mod_completo) em seguida.\n\n\nmod_completo <- lm(medv ~ ., data=Boston)\nsummary(mod_completo)\n\n\n\nCall:\nlm(formula = medv ~ ., data = Boston)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-15.595  -2.730  -0.518   1.777  26.199 \n\nCoefficients:\n              Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  3.646e+01  5.103e+00   7.144 3.28e-12 ***\ncrim        -1.080e-01  3.286e-02  -3.287 0.001087 ** \nzn           4.642e-02  1.373e-02   3.382 0.000778 ***\nindus        2.056e-02  6.150e-02   0.334 0.738288    \nchas         2.687e+00  8.616e-01   3.118 0.001925 ** \nnox         -1.777e+01  3.820e+00  -4.651 4.25e-06 ***\nrm           3.810e+00  4.179e-01   9.116  < 2e-16 ***\nage          6.922e-04  1.321e-02   0.052 0.958229    \ndis         -1.476e+00  1.995e-01  -7.398 6.01e-13 ***\nrad          3.060e-01  6.635e-02   4.613 5.07e-06 ***\ntax         -1.233e-02  3.760e-03  -3.280 0.001112 ** \nptratio     -9.527e-01  1.308e-01  -7.283 1.31e-12 ***\nblack        9.312e-03  2.686e-03   3.467 0.000573 ***\nlstat       -5.248e-01  5.072e-02 -10.347  < 2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 4.745 on 492 degrees of freedom\nMultiple R-squared:  0.7406,    Adjusted R-squared:  0.7338 \nF-statistic: 108.1 on 13 and 492 DF,  p-value: < 2.2e-16\n\nQual modelo ficou melhor: mod_simples, mod_multiplo ou mod_completo?\n\\(\\blacktriangleright\\) Resposta: Novamente considerando o R2 ajustado, o modelo mais adequado entre os três modelos é o mod_completo, pois tem o R2 ajustado é igual a 0,7338; que é maior do que o R2 ajustados dos demais modelos. Além disso, as variáveis explicativas, exceto indus e age, foram signifitivas ao nível de significância de 5%.\nEm relação aos resíduos, o modelo completo tem o mesmo problema dos outros dois modelos. Nesse caso, o modelo completo também pode ser melhorado.\n\n\n# Resíduo modelo completo\nplot(mod_completo)\n\n\n\n\nO valor estimado para o termo rm variou entre os três modelos? Por qual razão você acha que isso aconteceu?\n\\(\\blacktriangleright\\) Resposta: Sim, a estimativa para o termo rm variou devido a inclusão de variáveis de explicativas no modelo.\n\n\n\n",
    "preview": "posts/2021-02-04-curso-r-regresso-linear-br-exerccios-rlsm/curso-r-regresso-linear-br-exerccios-rlsm_files/figure-html5/unnamed-chunk-4-1.png",
    "last_modified": "2021-02-04T21:42:12-03:00",
    "input_file": "curso-r-regresso-linear-br-exerccios-rlsm.utf8.md"
  }
]
